<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GOALSURGE! ‚Äî ROUND 1</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=VT323&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="nav" id="nav">
        <a href="index.html">HOME</a>
        <a href="predict.html" class="active">PLAY</a>
        <a href="scores.html">SCORES</a>
        <a href="rules.html">RULES</a>
    </div>  

    <div class="hero-section">
        <div class="arena-banner">
            <div class="sprite-player"></div>
            <div class="sprite-ball"></div>
        </div>
        <div class="hero-content">
            <h1 class="glitch">GOALSURGE!</h1>
            <div class="hero-sub">ROUND 1 - GROUP STAGE</div>
        </div>
    </div>

    <div id="startupPopup" class="arcade-popup" style="display:flex;">
        <div class="popup-msg">
            <strong style="color:var(--neon-yellow)">READY PLAYER ONE?</strong><br><br>
            THE SUBMISSION WINDOW WILL OPEN NEAR TO THE START OF THE TOURNAMENT.<br><br>
            YOU CAN CLICK THROUGH TO UNDERSTAND THE GAME BUT YOUR SELECTIONS WILL NOT BE SAVED.
        </div>
        <button id="startupBtn">INSERT COIN (IT'S FREE)</button>
    </div>

    <div id="rulesPopup" class="arcade-popup">
        <div class="popup-msg" style="text-align: justify; font-size: 16px;">
            THERE WILL BE 48 TEAMS PLAYING AT WORLD CUP 2026. TOP 2 TEAMS FROM EACH OF THE 12 GROUPS QUALIFY.<br><br>
            THE 8 BEST THIRD-PLACED TEAMS ALSO QUALIFY. LONG LIVE INFANTINO! :D $$$
        </div>
        <button id="rulesBtn">OK</button>
    </div>

    <div class="panel">
        <h1>PLAYER INFO</h1>
        
        <input id="username" placeholder="USERNAME (REQUIRED)">
        <input id="email" placeholder="EMAIL ADDRESS (REQUIRED)">
        <input id="leaguePin" placeholder="LEAGUE PIN (OPTIONAL)" maxlength="4">

        <div class="terms-container">
            <label><input type="checkbox" id="privacyCheck"> <span>I ACCEPT THE <a href="#">PRIVACY POLICY</a> (REQUIRED)</span></label>
            <label><input type="checkbox" id="termsCheck"> <span>I ACCEPT THE <a href="#">TERMS OF USE</a> (REQUIRED)</span></label>
            <label><input type="checkbox" id="marketingCheck"> <span>TELL ME ABOUT FUTURE GOALSURGE! COMPETITIONS (OPTIONAL).</span></label>
        </div>
        <div class="sys" id="s1msg">AWAITING CREDENTIALS...</div>
    </div>  

    <div class="panel">
        <h1>ROUND 1: GROUP STAGE</h1>
        
        <div id="round1Container" class="dimmed">
            <button id="comboTrigger" style="width:100%;">CHOOSE SCORER DUO</button>
            <select id="combo" style="display:none;">
                <option value="">SELECT SCORER DUO</option>
                <option>Messi & Ronaldo</option>
                <option>Neymar & Mbapp√©</option>
                <option>Lewandowski & Haaland</option>
                <option>Salah & Man√©</option>
                <option>Kane & Sterling</option>
                <option>Vin√≠cius & Pedri</option>
            </select>

            <input id="goals" placeholder="TOTAL GOALS (TIEBREAKER)" type="number">
            
            <div style="font-family:'VT323'; font-size:22px; color:var(--text-main); margin: 20px 0; text-transform:uppercase;">
                PICKING 1ST PLACE IS TOO EASY. SELECT 2ND PLACE & 8 THIRD-PLACE QUALIFIERS
            </div>

            <div class="groups-grid" id="groupsGrid"></div>
        </div>
    </div> 

    <button id="lockBtn" style="width: 100%; max-width: 600px; font-size: 18px;" disabled>LOCK PICKS & BONUS ROUND</button>

    <div id="arcadePopup" class="arcade-popup">
        <div class="popup-msg" id="popupMsg"></div>
        <div id="progressBarContainer" style="display:none; width:100%;">
            <div class="progress-track">
                <div id="progressFill" class="progress-fill"></div>
            </div>
        </div>
        <button id="popupBtn">OK</button>
    </div>

    <div id="infoTooltip" class="info-tooltip">
        <div class="tooltip-text" id="tooltipText"></div>
    </div>

    <div class="overlay" id="overlay">
      <div class="modal">
        <div style="font-family:'Press Start 2P'; color:#fff; margin-bottom:15px; font-size:12px;">BONUS PLAYER SELECTOR</div>
        <div class="top-player" id="topPlayer">???</div>
        <div class="subtitle" id="twistSub" style="margin-bottom:20px; color:#888;">STICK OR TWIST?</div>
        <div class="actions">
          <button id="stickBtn">STICK</button>
          <button id="twistBtn">TWIST (2)</button>
        </div>
        <div class="grid" id="grid"></div>
      </div>
    </div>  

    <div class="submit-overlay" id="submitOverlay">
      <div class="submit-box">
        <div class="submit-header">GOALSURGE ENTRY TICKET</div>
        
        <div class="submit-body">
            <div class="compact-info">
                <span style="color:var(--neon-cyan)">PLAYER:</span> <span id="sumUser"></span><br>
                <span style="color:#aaa">EMAIL:</span> <span id="sumEmail"></span><br>
                <span style="color:#aaa">PIN:</span> <span id="sumPin"></span>
            </div>
            
            <div class="sc-box">
                <div class="sc-title">OFFICIAL SCORER TRIO</div>
                <div id="sumScorers" class="sc-val"></div>
            </div>

            <div class="compact-grid" id="sumGrid"></div>

            <div style="text-align:center; margin-top:20px; border-top: 2px dashed #333; padding-top:15px;">
                <div style="color:var(--neon-pink); font-family:'Press Start 2P'; font-size: 10px; margin-bottom:10px;">[ CAPTURE SCREENSHOT NOW ]</div>
                <button onclick="location.reload()" style="font-size:10px; padding:10px;">EXIT GAME</button>
            </div>
        </div>
      </div>
    </div> 
    <footer class="footer-nav">
        <a href="privacy.html">PRIVACY POLICY</a>
        <a href="terms.html">TERMS OF USE</a>
    </footer>

<script>
'use strict';
/* ---------- POPUP LOGIC ---------- */
const startupPopup = document.getElementById('startupPopup');
document.getElementById('startupBtn').onclick = () => { startupPopup.style.display = 'none'; };

const rulesPopup = document.getElementById('rulesPopup');
document.getElementById('rulesBtn').onclick = () => { rulesPopup.style.display = 'none'; };

/* ---------- STATE VARIABLES ---------- */
const usernameInput=document.getElementById('username'),
emailInput=document.getElementById('email'),
leaguePinInput=document.getElementById('leaguePin'),
privacyCheck=document.getElementById('privacyCheck'),
termsCheck=document.getElementById('termsCheck'),
comboSelect=document.getElementById('combo'),
comboTrigger=document.getElementById('comboTrigger'),
goalsInput=document.getElementById('goals'),
s1msg=document.getElementById('s1msg'),
lockBtn=document.getElementById('lockBtn'),
round1Container=document.getElementById('round1Container');

/* ---------- TOOLTIPS ---------- */
const infoTooltip = document.getElementById('infoTooltip');
const tooltipText = document.getElementById('tooltipText');
let tooltipTimeout;

function showTooltip(msg, duration = 3000) {
    tooltipText.textContent = msg;
    infoTooltip.style.display = 'block';
    clearTimeout(tooltipTimeout);
    tooltipTimeout = setTimeout(() => {
        infoTooltip.style.display = 'none';
    }, duration);
}

usernameInput.addEventListener('focus', () => showTooltip('DISPLAY NAME FOR LEADERBOARD'));
emailInput.addEventListener('focus', () => showTooltip('INSERT VALID EMAIL ADDRESS, REQUIRED'));
leaguePinInput.addEventListener('focus', () => showTooltip('ENTER AN EXISTING PIN OR CREATE A NEW ONE AND SHARE IT WITH YOUR FRIENDS.'));
goalsInput.addEventListener('focus', () => showTooltip('TOTAL GOALS IN GROUP STAGE (TIEBREAKER)'));

/* ---------- FLOW CONTROLLER ---------- */
function updateTerminalState() {
    const isNameValid = usernameInput.value.trim().length > 2;
    const isEmailValid = emailInput.value.includes('@') && emailInput.value.includes('.');
    const areTermsChecked = privacyCheck.checked && termsCheck.checked;
    const isIdentityComplete = isNameValid && isEmailValid && areTermsChecked;

    if (!isIdentityComplete) {
        s1msg.textContent = "AWAITING CREDENTIALS...";
        s1msg.className = "sys";
        round1Container.classList.add('dimmed');
    } else {
        s1msg.textContent = "ACCESS GRANTED. SYSTEM UNLOCKED.";
        s1msg.className = "sys complete";
        round1Container.classList.remove('dimmed');
    }

    const isGoalsValid = goalsInput.value > 0;
    const isComboSelected = comboSelect.value !== "";
    const secondComplete = state.secondPicks.every(x => x !== null);
    const thirdComplete = state.thirdPicks.filter(x => x !== null).length === MAX_THIRD;
    
    lockBtn.disabled = !(isIdentityComplete && isComboSelected && isGoalsValid && secondComplete && thirdComplete);
}

[usernameInput, emailInput, comboSelect, goalsInput, privacyCheck, termsCheck].forEach(el => {
    el.addEventListener('input', updateTerminalState);
    el.addEventListener('change', updateTerminalState);
});

comboTrigger.onclick = () => {
    showPopup("These two players and your Bonus Player (chosen at the end) will earn points for you with goals and assists in the Group Stage.");
    const btn = document.getElementById('popupBtn');
    btn.onclick = () => {
        document.getElementById('arcadePopup').style.display = 'none';
        comboTrigger.style.display = 'none';
        comboSelect.style.display = 'block';
        updateTerminalState();
        btn.onclick = () => { document.getElementById('arcadePopup').style.display = 'none'; };
    };
};

/* ---------- GROUP PICKS LOGIC ---------- */
const GROUPS=[ 
["MEXICO üá≤üáΩ","S.AFRICA üáøüá¶","S.KOREA üá∞üá∑","DEN/IRL üá©üá∞"],
["CANADA üá®üá¶","ITALY üáÆüáπ","QATAR üá∂üá¶","SWITZ üá®üá≠"],
["BRAZIL üáßüá∑","MOROCCO üá≤üá¶","HAITI üá≠üáπ","SCOTLAND üè¥Û†ÅßÛ†Å¢Û†Å≥Û†Å£Û†Å¥Û†Åø"],
["USA üá∫üá∏","PARAGUAY üáµüáæ","AUSTRALIA üá¶üá∫","TURKEY üáπüá∑"],
["GERMANY üá©üá™","CURA√áAO üá®üáº","IVORY C. üá®üáÆ","ECUADOR üá™üá®"],
["NETH. üá≥üá±","JAPAN üáØüáµ","POLAND üáµüá±","TUNISIA üáπüá≥"],
["BELGIUM üáßüá™","EGYPT üá™üá¨","IRAN üáÆüá∑","NZ üá≥üáø"],
["SPAIN üá™üá∏","C.VERDE üá®üáª","SAUDI üá∏üá¶","URUGUAY üá∫üáæ"],
["FRANCE üá´üá∑","SENEGAL üá∏üá≥","BOLIVIA üáßüá¥","NORWAY üá≥üá¥"],
["ARGENTINA üá¶üá∑","ALGERIA üá©üáø","AUSTRIA üá¶üáπ","JORDAN üáØüá¥"],
["PORTUGAL üáµüáπ","JAMAICA üáØüá≤","UZBEK üá∫üáø","COLOMBIA üá®üá¥"],
["ENGLAND üè¥Û†ÅßÛ†Å¢Û†Å•Û†ÅÆÛ†ÅßÛ†Åø","CROATIA üá≠üá∑","GHANA üá¨üá≠","PANAMA üáµüá¶"]
];
const letters="ABCDEFGHIJKL".split('');
const MAX_THIRD=8;
const state={ secondPicks:Array(GROUPS.length).fill(null), thirdPicks:Array(GROUPS.length).fill(null) };
const groupsGrid=document.getElementById('groupsGrid');

const popup = document.getElementById('arcadePopup');
const popupMsg = document.getElementById('popupMsg');
const popupBtn = document.getElementById('popupBtn');
const progressBarContainer = document.getElementById('progressBarContainer');
const progressFill = document.getElementById('progressFill');

function showPopup(msg, isProgress=false, count=0) {
    popupMsg.textContent = msg;
    popup.style.display = 'flex';
    if(isProgress) {
        popupBtn.style.display = 'none';
        progressBarContainer.style.display = 'block';
        const pct = (count / MAX_THIRD) * 100;
        progressFill.style.width = pct + '%';
        setTimeout(() => { popup.style.display = 'none'; }, 1500);
    } else {
        popupBtn.style.display = 'block';
        progressBarContainer.style.display = 'none';
    }
}

function renderGroups(){ 
    groupsGrid.innerHTML='';
    GROUPS.forEach((teams, i) => {
        const g=document.createElement('div'); g.className='group';
        g.innerHTML = `<h4>GROUP ${letters[i]}</h4>`;
        teams.forEach((team, idx) => {
            const row=document.createElement('div');
            row.className='team-row';
            row.innerHTML = `<span class="team-name">${team}</span>
                <button class="team-btn" onclick="togglePick(${i}, ${idx}, 'second', this)">2ND</button>
                <button class="team-btn" onclick="togglePick(${i}, ${idx}, 'third', this)">3RD</button>`;
            g.appendChild(row);
        });
        groupsGrid.appendChild(g);
    });
}

function togglePick(groupIndex, teamIndex, type, btn) {
    if (type === 'second' && state.thirdPicks[groupIndex] === teamIndex) { showPopup("ALREADY PICKED AS 3RD"); return; }
    if (type === 'third' && state.secondPicks[groupIndex] === teamIndex) { showPopup("ALREADY PICKED AS 2ND"); return; }

    if (type === 'second') {
        const current = state.secondPicks[groupIndex];
        if (current === teamIndex) {
            state.secondPicks[groupIndex] = null;
            btn.classList.remove('selected-2');
        } else {
            const groupDiv = groupsGrid.children[groupIndex];
            const oldBtn = groupDiv.querySelector('.selected-2');
            if(oldBtn) oldBtn.classList.remove('selected-2');
            state.secondPicks[groupIndex] = teamIndex;
            btn.classList.add('selected-2');
        }
    } else {
        if (state.thirdPicks[groupIndex] === teamIndex) {
            state.thirdPicks[groupIndex] = null;
            btn.classList.remove('selected-3');
            showPopup(`${state.thirdPicks.filter(x=>x!==null).length}/8 THIRD PLACE TEAMS`, true, state.thirdPicks.filter(x=>x!==null).length);
        } else {
            if (state.thirdPicks.filter(x=>x!==null).length >= MAX_THIRD) { showPopup("MAX 8 REACHED"); return; }
            const groupDiv = groupsGrid.children[groupIndex];
            const oldBtn = groupDiv.querySelector('.selected-3');
            if(oldBtn) oldBtn.classList.remove('selected-3');
            state.thirdPicks[groupIndex] = teamIndex;
            btn.classList.add('selected-3');
            showPopup(`${state.thirdPicks.filter(x=>x!==null).length}/8 THIRD PLACE TEAMS`, true, state.thirdPicks.filter(x=>x!==null).length);
        }
    }
    updateTerminalState();
}

/* ---------- BONUS ROUND ---------- */
const PLAYERS=['MESSI','RONALDO','MBAPP√â','HAALAND','SALAH','KANE','NEYMAR','VIN√çCIUS','PEDRI','GRIEZMANN','BELLINGHAM','LEWANDOWSKI','SON','OSIMHEN','SAKA','RASHFORD','FODEN','MUSIALA'];
let finalPlayer = null;
let twists = 2;

lockBtn.onclick = () => {
    document.getElementById('overlay').style.display = 'flex';
    initBonusGame();
};

function initBonusGame() {
    const grid = document.getElementById('grid');
    grid.innerHTML = '';
    PLAYERS.forEach(p => {
        const div = document.createElement('div');
        div.className = 'player-box';
        div.textContent = p;
        grid.appendChild(div);
    });
    spinWheel();
}

function spinWheel(isFinal = false) {
    const boxes = document.querySelectorAll('.player-box');
    let spins = 0;
    const interval = setInterval(() => {
        boxes.forEach(b => b.classList.remove('active'));
        const r = Math.floor(Math.random() * boxes.length);
        boxes[r].classList.add('active');
        document.getElementById('topPlayer').textContent = boxes[r].textContent;
        spins++;
        if(spins > 20) {
            clearInterval(interval);
            finalPlayer = boxes[r].textContent;
            boxes[r].classList.add('selected');
            if(isFinal) setTimeout(showFinalSummary, 1500);
        }
    }, 80);
}

document.getElementById('twistBtn').onclick = () => {
    if(twists > 0) {
        twists--;
        document.getElementById('twistBtn').textContent = `TWIST (${twists})`;
        document.querySelectorAll('.player-box').forEach(b => b.classList.remove('selected'));
        spinWheel(twists === 0);
    }
};

document.getElementById('stickBtn').onclick = showFinalSummary;

function showFinalSummary() {
    document.getElementById('overlay').style.display = 'none';
    document.getElementById('sumUser').textContent = usernameInput.value.toUpperCase();
    document.getElementById('sumEmail').textContent = emailInput.value.toUpperCase();
    document.getElementById('sumPin').textContent = leaguePinInput.value || "N/A";
    document.getElementById('sumScorers').textContent = comboSelect.value.toUpperCase() + " + " + finalPlayer;
    const grid = document.getElementById('sumGrid');
    grid.innerHTML = ''; 
    GROUPS.forEach((teams, i) => {
        const div = document.createElement('div'); div.className = 'compact-row';
        const p2 = state.secondPicks[i] !== null ? teams[state.secondPicks[i]] : '-';
        const p3 = state.thirdPicks[i] !== null ? teams[state.thirdPicks[i]] : '';
        div.innerHTML = `<div><strong>${letters[i]}</strong> ${p2}</div>` + (p3 ? `<div class="p3">/ ${p3}</div>` : '');
        grid.appendChild(div);
    });
    document.getElementById('submitOverlay').style.display = 'flex';
}

renderGroups();
updateTerminalState();
</script> 
</body>
</html>
